---
apiVersion: helm.toolkit.fluxcd.io/v2
kind: HelmRelease
metadata:
  name: nextcloud
  namespace: nextcloud
spec:
  test:
    enable: false
  values:
    replicaCount: 1
    nextcloud:
      configs:
        staging.config.php: |-
          <?php
          $CONFIG = array (
            'auth.bruteforce.protection.enabled' => false,
          );
        valkey-cluster.config.php: |-
          <?php
          $CONFIG = array (
            'redis.cluster' => array (
              'seeds' => [
                'valkey-cluster.database:6379',
              ],
              'timeout' => 0.0,
              'read_timeout' => 0.0,
              'failover_mode' => '\RedisCluster::FAILOVER_ERROR',
              'password' => getenv('VALKEY_CLUSTER_PASSWORD'),
            ),
          );
        redis-cluster.config.php: null
    persistence:
      size: 2Gi
