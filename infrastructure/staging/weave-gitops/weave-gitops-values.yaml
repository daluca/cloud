---
apiVersion: helm.toolkit.fluxcd.io/v2beta1
kind: HelmRelease
metadata:
  name: weave-gitops
  namespace: flux-system
spec:
  chart:
    spec:
      version: ">=4.0.0 <5.0.0"
  test:
    enable: false
  values:
    replicaCount: 2
    adminUser:
      create: true
      username: ${WEAVE_GITOPS_ADMIN_USERNAME}
      passwordHash: ${WEAVE_GITOPS_ADMIN_PASSWORD}
    ingress:
      annotations:
        cert-manager.io/cluster-issuer: letsencrypt-cloudflare
      hosts:
        - host: flux.${TERTIARY_DOMAIN}
          paths:
            - pathType: Prefix
              path: /
      tls:
        - secretName: gitops-stg-tls
          hosts:
            - flux.${TERTIARY_DOMAIN}
