---
apiVersion: helm.toolkit.fluxcd.io/v2beta1
kind: HelmRelease
metadata:
  name: crowdsec
  namespace: crowdsec
spec:
  chart:
    spec:
      version: ">=0.8.0 <0.9.0"
  test:
    enable: false
  values:
    config:
      postoverflows:
        s01-whitelist:
          staging-whitelist.yaml: |-
            name: daluca/staging-whitelist
            description: "Whitelist staging environment"
            whitelist:
              reason: "staging enironment trusted CIDR range"
              cidr:
                - ${STAGING_IP_ALLOW_LIST}
    lapi:
      dashboard:
        ingress:
          host: crowdsec.${TERTIARY_DOMAIN}
          tls:
            - secretName: crowdsec-stg-tls
              hosts:
                - crowdsec.${TERTIARY_DOMAIN}
