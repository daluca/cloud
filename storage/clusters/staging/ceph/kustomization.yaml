---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
  - ../../base/ceph
  - ceph-dashboard-credentials.sops.yaml
patches:
  - target:
      kind: CephCluster
      name: rook-ceph
    patch: |-
      - op: replace
        path: /spec/cephVersion/image
        value: quay.io/ceph/ceph:v17.2.3
      - op: replace
        path: /spec/storage/storageClassDeviceSets/0/volumeClaimTemplates/0/spec/resources/requests/storage
        value: 10Gi
  - target:
      kind: Ingress
      name: rook-ceph-mgr-dashboard
    patch: |-
      - op: replace
        path: /spec/rules/0/host
        value: rook.${TERTIARY_DOMAIN}
      - op: replace
        path: /spec/tls/0/hosts/0
        value: rook.${TERTIARY_DOMAIN}
      - op: replace
        path: /spec/tls/0/secretName
        value: rook-stg-tls
